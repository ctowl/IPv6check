#!/bin/sh /etc/rc.common

START=95
STOP=10
PID_FILE="/var/run/ipv6-check.pid"
SCRIPT="/usr/bin/ipv6_check.sh"
INTERVAL=120  # 每两分钟

start() {
    echo "Starting IPv6 checker daemon..."
    [ -f "$PID_FILE" ] && echo "Already running" && return 1

    (
        while true; do
            $SCRIPT
            sleep $INTERVAL
        done
    ) &
    echo $! > "$PID_FILE"
}

stop() {
    echo "Stopping IPv6 checker daemon..."
    [ -f "$PID_FILE" ] && kill "$(cat $PID_FILE)" 2>/dev/null && rm -f "$PID_FILE"
}
